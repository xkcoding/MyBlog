---
import { SITE } from "@/config";

type Props = {
  class?: string;
  postUrl: string;
};

const { class: className = "", postUrl } = Astro.props;

const showLicense = SITE.license.enabled;
const licenseType = SITE.license.type;
const licenseUrl = SITE.license.url;
const fullUrl = `${SITE.website.replace(/\/$/, "")}${postUrl}`;
---

{
  showLicense && (
    <div
      class:list={[
        "flex flex-wrap items-center gap-4 rounded-lg border border-foreground/10 bg-foreground/5 px-5 py-4",
        className,
      ]}
    >
      {/* CC BY-NC-SA Official Badge */}
      <a
        href={licenseUrl}
        target="_blank"
        rel="noopener noreferrer license"
        class="shrink-0"
      >
        <img
          src="https://licensebuttons.net/l/by-nc-sa/4.0/88x31.png"
          alt={licenseType}
          class="h-8"
          width="88"
          height="31"
          loading="lazy"
        />
      </a>
      {/* License Text */}
      <div class="flex flex-col gap-1 text-sm">
        <p class="text-foreground/70">
          本文采用
          <a
            href={licenseUrl}
            target="_blank"
            rel="noopener noreferrer license"
            class="font-medium text-accent hover:underline"
          >
            {licenseType}
          </a>
          协议，转载请注明出处。
        </p>
        <p class="text-foreground/50">
          原文链接：
          <a href={fullUrl} class="break-all text-accent/80 hover:underline">
            {fullUrl}
          </a>
        </p>
      </div>
    </div>
  )
}
